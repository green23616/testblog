# Phase 7.1 - Split View Editor Design Document

**Date**: December 18, 2025
**Phase**: 7 - Post Creation UI Redesign
**Status**: Design Phase

---

## Overview

Redesign the post creation/editing page with a split-view layout featuring:
- **Left Panel**: Form fields + Markdown editor (EasyMDE)
- **Right Panel**: Live preview with rendered markdown

---

## Current State

**PostForm.tsx** (single-column vertical layout):
```
┌─────────────────────────┐
│ Title Input             │
│ Slug Input              │
│ Excerpt Textarea        │
│ Featured Image Upload   │
│ Markdown Editor (EasyMDE)│
│ Tags Selection          │
│ SEO Metadata            │
│ Publish Toggle          │
│ [Save] [Cancel]         │
└─────────────────────────┘
```

**Issues**:
- No live preview (must toggle EasyMDE side-by-side mode)
- Editor preview buttons clutter toolbar
- Not Velog-style UX

---

## Target State

**Split-view layout (desktop ≥1024px)**:
```
┌─────────────────────────┬─────────────────────────┐
│  LEFT PANEL             │  RIGHT PANEL            │
│  (Editor & Settings)    │  (Live Preview)         │
│                         │                         │
│  Title Input            │  # Rendered Title       │
│  Slug (auto-generated)  │                         │
│  Excerpt                │  Rendered markdown      │
│  Tags                   │  with syntax highlight  │
│  Markdown Editor        │                         │
│  (EasyMDE - simplified) │  [Sticky panel]         │
│                         │                         │
│  [SEO Section]          │  [Scrollable content]   │
│  [Image Upload]         │                         │
│  [Publish Toggle]       │                         │
│  [Save] [Cancel]        │                         │
└─────────────────────────┴─────────────────────────┘
```

**Mobile (<1024px)**: Stack vertically (editor on top, preview below)

---

## Components to Create

### 1. PreviewPanel.tsx

**Location**: `/src/components/admin/PreviewPanel.tsx`

**Props**:
```typescript
interface PreviewPanelProps {
  title: string;
  content: string;
}
```

**Features**:
- Sticky positioning (`sticky top-4`)
- Shows "Preview" label
- Renders title as H1
- Uses `MarkdownRenderer` for content
- Empty state: "Start writing to see the preview..."
- Max height with scroll: `max-h-[calc(100vh-2rem)]`
- Border, padding, background
- Dark mode support

**File Size**: ~30 lines

---

## Components to Modify

### 1. MarkdownEditor.tsx

**Changes**: Update toolbar array (remove preview buttons)

**Before**:
```typescript
toolbar: [
  // ... other buttons
  'preview',        // ❌ Remove
  'side-by-side',   // ❌ Remove
  'fullscreen',
  'guide',
]
```

**After**:
```typescript
toolbar: [
  'bold', 'italic', 'strikethrough',
  '|',
  'heading-1', 'heading-2', 'heading-3',
  '|',
  'quote', 'unordered-list', 'ordered-list',
  '|',
  'link', 'image', 'code', 'table',
  '|',
  'fullscreen',  // ✅ Keep for focus mode
  '|',
  'guide',
]
```

**Impact**: Low (simple array modification)

---

### 2. PostForm.tsx

**Changes**: Major refactor to 2-column grid layout

**Before** (single column):
```typescript
<form className="space-y-6">
  {/* All fields stacked vertically */}
</form>
```

**After** (split layout):
```typescript
<form className="space-y-6">
  {/* Top: Title input (full width) */}
  <div>
    <input type="text" id="title" ... />
  </div>

  {/* Split into 2 columns */}
  <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
    {/* LEFT PANEL */}
    <div className="space-y-6">
      <div>{/* Slug */}</div>
      <div>{/* Excerpt */}</div>
      <div>{/* Tags */}</div>
      <div>{/* Markdown Editor */}</div>
      <div>{/* SEO Section */}</div>
      <div>{/* Image Upload */}</div>
      <div>{/* Publish Toggle */}</div>
      <div>{/* Action Buttons */}</div>
    </div>

    {/* RIGHT PANEL */}
    <div className="sticky top-4 h-fit">
      <PreviewPanel
        title={formData.title}
        content={formData.content}
      />
    </div>
  </div>
</form>
```

**Impact**: High (major layout restructuring)

---

## Technical Decisions

### 1. Grid Layout
- **Choice**: CSS Grid with `grid-cols-1 lg:grid-cols-2`
- **Why**: Simple, responsive, Tailwind-native
- **Breakpoint**: 1024px (lg)

### 2. Sticky Positioning
- **Choice**: `sticky top-4` on right panel
- **Why**: Preview stays visible while scrolling left panel
- **Height**: `max-h-[calc(100vh-2rem)]` with overflow scroll

### 3. Real-time Updates
- **Choice**: Direct prop passing (no debounce initially)
- **Why**: React re-renders are fast enough for typing
- **Future**: Can add 300ms debounce if performance issues

### 4. Mobile Strategy
- **Choice**: Stack vertically (no tabs)
- **Why**: Simpler UX, less code
- **Future**: Can add Edit/Preview tabs if needed

---

## Implementation Order

1. ✅ Create `PreviewPanel.tsx` (30 mins)
2. ✅ Update `MarkdownEditor.tsx` toolbar (10 mins)
3. ✅ Refactor `PostForm.tsx` layout (2-3 hours)
4. ✅ Test desktop split-view (30 mins)
5. ✅ Test mobile stacked layout (30 mins)
6. ✅ Test dark mode (15 mins)
7. ✅ Verify form functionality (30 mins)

**Total**: 4-5 hours

---

## Testing Checklist

- [ ] Desktop (≥1024px): Side-by-side layout works
- [ ] Tablet (768-1023px): Layout stacks vertically
- [ ] Mobile (<768px): Layout stacks, editor usable
- [ ] Preview updates when typing in editor
- [ ] Preview shows title as H1
- [ ] Preview renders markdown correctly (links, code, lists)
- [ ] Dark mode: Both panels have correct colors
- [ ] Sticky positioning: Preview stays visible when scrolling
- [ ] Form submit: Still saves post correctly
- [ ] Tags selection: Still works
- [ ] Image upload: Still works
- [ ] SEO fields: Still accessible

---

## Files Modified

| File | Lines Changed | Type |
|------|---------------|------|
| `/src/components/admin/PreviewPanel.tsx` | +30 | Create |
| `/src/components/admin/MarkdownEditor.tsx` | ~10 | Modify |
| `/src/components/admin/PostForm.tsx` | ~50 | Refactor |

**Total**: ~90 lines of code

---

## Risk Mitigation

**Risk 1**: Layout breaks on edge cases (unusual screen sizes)
- **Mitigation**: Test at 1023px, 1024px, 1025px breakpoints

**Risk 2**: Preview performance with large markdown content
- **Mitigation**: Monitor performance, add debounce if needed

**Risk 3**: Form submission breaks after refactoring
- **Mitigation**: Test all form fields before and after

**Risk 4**: Dark mode colors don't match
- **Mitigation**: Use same Tailwind classes as existing components

---

## Success Criteria

✅ Phase 7 complete when:
1. Split-view layout works on desktop
2. Preview updates in real-time
3. Responsive layout works on mobile
4. Dark mode styling correct
5. All form functionality intact
6. No console errors
7. No performance regressions

---

**Next Steps**: Create PreviewPanel component → Update MarkdownEditor → Refactor PostForm

# Phase 6 Plan: Content & Performance

**Date**: December 13, 2025
**Status**: Planning
**Version**: v0.6.0 (planned)

---

## Overview

Complete deferred content features and optimize for production readiness with focus on markdown workflow, content creation, and user engagement.

---

## Features to Implement

### 1. Markdown Posting Strategies üìù

**Goal**: Define and document best practices for markdown-based blog posting

**Analysis Points**:

- Rich text editor options (Markdown-first vs WYSIWYG)
- Storage format (raw markdown vs HTML vs both)
- Preview functionality requirements
- Image handling in markdown
- Code block formatting standards
- Front matter vs database fields

**Recommended Approaches**:

- **Option A - Pure Markdown**: Store markdown, render on display (react-markdown)
- **Option B - MDX**: Markdown with JSX components for interactive content
- **Option C - Hybrid**: Rich editor (Tiptap) with markdown export/import
- **Option D - WYSIWYG**: Rich editor storing HTML (current textarea++)

**Decision Factors**:

- Developer experience (writing in markdown vs editor)
- Content portability (markdown = portable)
- Feature richness (embeds, interactive components)
- Migration path (current DB has HTML-like content)

---

### 2. Code Syntax Highlighting üé®

**Goal**: Beautiful code display in blog posts

**Implementation**:

- **Library**: `react-syntax-highlighter` or `shiki`
- **Themes**: Support light/dark mode themes
- **Languages**: Auto-detect or explicit language tags
- **Features**:
  - Line numbers
  - Copy to clipboard button
  - Line highlighting
  - File name labels

**Integration Points**:

- Blog post display (`/blog/[slug]/page.tsx`)
- Preview in admin (if using markdown editor)
- Works with both markdown and HTML content

**Files to Modify**:

- `src/components/CodeBlock.tsx` (new component)
- `src/app/blog/[slug]/page.tsx` (integrate code blocks)
- `package.json` (add dependencies)

---

### 3. Rich Text Editor üìÑ

**Goal**: Replace basic textarea with feature-rich editing experience

**Editor Options**:

1. **Tiptap** (Recommended)

   - Pros: Headless, extensible, markdown support, modern
   - Cons: Requires setup
   - Best for: Flexible customization

2. **React-Quill**

   - Pros: Easy setup, WYSIWYG
   - Cons: Less modern, limited markdown
   - Best for: Quick implementation

3. **Lexical** (Meta)

   - Pros: Modern, powerful, Facebook-backed
   - Cons: Complex setup
   - Best for: Advanced features

4. **SimpleMDE / EasyMDE**
   - Pros: Pure markdown, simple
   - Cons: Less features
   - Best for: Markdown purists

**Recommendation**: **Tiptap** with markdown extension

- Modern architecture
- Markdown import/export
- Extensible for future features
- Good TypeScript support
- Active development

**Features to Include**:

- Bold, italic, underline
- Headings (H1-H6)
- Lists (ordered, unordered)
- Links
- Images (integrate with ImageUploader)
- Code blocks (inline and fenced)
- Blockquotes
- Tables
- Markdown mode toggle
- Preview mode
- Auto-save (future)

**Files to Create**:

- `src/components/admin/RichTextEditor.tsx`
- `src/lib/tiptap/extensions.ts` (if using Tiptap)

**Files to Modify**:

- `src/components/admin/PostForm.tsx` (replace textarea)
- `package.json` (add @tiptap dependencies)

---

### 4. Mockup Blog Data üìö

**Goal**: Create 12 realistic blog posts with longer content for pagination testing

**Content Requirements**:

- **Length**: 800-2000 words per post
- **Variety**: Mix of technical topics
- **Code Examples**: Include code blocks for syntax highlighting test
- **Images**: Use featured images (via Supabase Storage)
- **Tags**: Distribute across different tags
- **Dates**: Spread over 3 months for realistic timeline

**Post Topics** (Suggested):

1. "Getting Started with Next.js 16 App Router"
2. "TypeScript Best Practices for React Developers"
3. "Building a REST API with Supabase and Next.js"
4. "Dark Mode Implementation with TailwindCSS"
5. "Optimizing Web Performance: A Complete Guide"
6. "Understanding React Server Components"
7. "Database Design for Scalable Applications"
8. "CSS Grid vs Flexbox: When to Use Each"
9. "Authentication Patterns in Modern Web Apps"
10. "Testing Strategies for Next.js Applications"
11. "Markdown vs Rich Text: Choosing a Content Format"
12. "Deploying Next.js to Production: Best Practices"

**Implementation**:

- Create SQL script: `supabase/mockup-posts.sql`
- Include markdown formatting
- Add code blocks for highlighting test
- Assign varied tags
- Set different publish dates

---

### 5. Pagination üìÑ

**Goal**: Implement pagination for blog list page

**Current State**: Loads all posts (fine for <100 posts)
**Target**: 12 posts per page with pagination controls

**Implementation Strategy**:

- **Approach**: Server-side pagination (better for SEO)
- **URL Pattern**: `/blog?page=2` (query params)
- **Database**: Use `LIMIT` and `OFFSET` in Supabase query
- **UI Components**:
  - Previous/Next buttons
  - Page numbers (show 5 at a time)
  - Jump to first/last page
  - Current page indicator

**Server Action Updates**:

```typescript
// getPosts(page: number = 1, perPage: number = 12)
// Returns: { posts, totalCount, currentPage, totalPages }
```

**Files to Create**:

- `src/components/Pagination.tsx`

**Files to Modify**:

- `src/app/actions/posts.ts` (add pagination params)
- `src/app/blog/page.tsx` (integrate pagination)

**Features**:

- Show total post count
- Disable prev/next at boundaries
- Maintain search query across pages
- Responsive design (mobile-friendly)

---

### 6. Social Sharing Buttons üîó

**Goal**: Enable easy sharing with Open Graph images

**Platforms**:

- Twitter/X
- LinkedIn
- Facebook
- Copy link to clipboard

**Implementation**:

- **Component**: `src/components/SocialShare.tsx`
- **Props**: title, url, description, image (OG image)
- **Features**:
  - Opens share in new window
  - Properly encoded URLs
  - Toast notification on copy
  - Dark mode support
  - Mobile-friendly

**Share URLs**:

```typescript
Twitter: `https://twitter.com/intent/tweet?text=${title}&url=${url}`;
LinkedIn: `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
Facebook: `https://www.facebook.com/sharer/sharer.php?u=${url}`;
```

**OG Image Handling**:

- Use `featured_image` if exists
- Fallback to `og_image` field
- Default placeholder if neither exists
- Validate image URL before sharing

**Files to Create**:

- `src/components/SocialShare.tsx`

**Files to Modify**:

- `src/app/blog/[slug]/page.tsx` (add share buttons)

**Position**: Below post content, above comments section

---

### 7. ISR Fine-Tuning ‚ö°

**Goal**: Optimize caching and revalidation for best performance

**Current State**: Default Next.js caching
**Target**: Optimized ISR with strategic revalidation

**Configuration Points**:

1. **Blog Post Pages** (`/blog/[slug]`):

   - Static generation at build time
   - ISR revalidation: 3600s (1 hour)
   - Fallback: 'blocking' (generate on-demand)

2. **Blog List** (`/blog`):

   - ISR revalidation: 300s (5 minutes)
   - Always show latest posts

3. **Admin Operations**:

   - Revalidate paths on post create/update/delete
   - `revalidatePath('/blog')`
   - `revalidatePath(`/blog/${slug}`)`

4. **Sitemap**:
   - Revalidation: 86400s (24 hours)

**Implementation**:

```typescript
// In page.tsx files
export const revalidate = 3600; // ISR revalidation time

// In Server Actions
import { revalidatePath } from "next/cache";
revalidatePath("/blog");
revalidatePath(`/blog/${slug}`);
```

**Optimization Strategy**:

- Hot content (blog list): 5-minute revalidation
- Stable content (individual posts): 1-hour revalidation
- Static content (sitemap): 24-hour revalidation
- Manual revalidation on admin actions

**Performance Targets**:

- First load: <1s
- Subsequent loads: <200ms (cached)
- Lighthouse Performance: >90

**Files to Modify**:

- `src/app/blog/page.tsx` (add revalidate export)
- `src/app/blog/[slug]/page.tsx` (add revalidate export)
- `src/app/sitemap.ts` (add revalidate export)
- `src/app/actions/posts.ts` (add revalidatePath calls)

---

## Implementation Order

### Phase 6.1: Content Foundation

1. **Markdown Strategy Discussion** (this document)
2. **Code Syntax Highlighting**
   - Install `react-syntax-highlighter`
   - Create CodeBlock component
   - Integrate into blog post display
   - Test with sample code

### Phase 6.2: Editor & Content

3. **Rich Text Editor**

   - Install Tiptap dependencies
   - Create RichTextEditor component
   - Integrate into PostForm
   - Test markdown import/export

4. **Mockup Data**
   - Write SQL script with 12 posts
   - Include code blocks and markdown
   - Run migration
   - Verify display

### Phase 6.3: User Features

5. **Pagination**

   - Update getPosts action
   - Create Pagination component
   - Integrate into blog list
   - Test navigation

6. **Social Sharing**
   - Create SocialShare component
   - Integrate into post pages
   - Test share URLs
   - Verify OG images

### Phase 6.4: Optimization

7. **ISR Fine-Tuning**
   - Add revalidate exports
   - Update Server Actions
   - Test cache behavior
   - Measure performance

---

## Dependencies to Install

```bash
# Code Syntax Highlighting
pnpm add react-syntax-highlighter
pnpm add -D @types/react-syntax-highlighter

# Rich Text Editor (Tiptap)
pnpm add @tiptap/react @tiptap/starter-kit @tiptap/extension-link @tiptap/extension-image @tiptap/extension-code-block-lowlight
pnpm add lowlight

# Social Sharing (if using toast notifications)
pnpm add sonner # or react-hot-toast
```

---

## Testing Checklist

### Markdown & Editor

- [ ] Code syntax highlighting works in light mode
- [ ] Code syntax highlighting works in dark mode
- [ ] Rich text editor saves markdown format
- [ ] Editor preview matches blog post display
- [ ] Images can be inserted via editor
- [ ] Markdown import/export works

### Content & Pagination

- [ ] 12 mockup posts display correctly
- [ ] Pagination shows correct page numbers
- [ ] Previous/Next buttons work
- [ ] Search works across paginated results
- [ ] Page URLs are shareable

### Social & Performance

- [ ] Twitter share opens with correct data
- [ ] LinkedIn share works
- [ ] Facebook share works
- [ ] Copy link shows toast notification
- [ ] OG images appear in share previews
- [ ] ISR caching works (check Network tab)
- [ ] Revalidation triggers on admin updates
- [ ] Build succeeds without errors

---

## Success Criteria

‚úÖ **Code Highlighting**: Code blocks render beautifully with syntax colors
‚úÖ **Rich Editor**: Admin can write posts in rich text or markdown
‚úÖ **Mockup Data**: 12 realistic blog posts exist for testing
‚úÖ **Pagination**: Blog list paginated, showing 12 posts per page
‚úÖ **Social Sharing**: Share buttons work, OG images display correctly
‚úÖ **ISR Optimized**: Pages cached, revalidation working, performance >90

---

## Future Enhancements (Phase 7+)

- MDX support for interactive content
- Image optimization in editor
- Auto-save drafts
- Rich embed support (YouTube, Twitter, CodePen)
- Table of contents generation
- Reading time calculation from word count
- Advanced search with filters
- Related posts algorithm
- Newsletter subscription
- Comment threading

---

**Plan Status**: Ready for implementation
**Next Step**: Start with markdown strategy discussion and code syntax highlighting
